<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="manifest" href="/manifest.json">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" /> -->
    <!-- <link rel="stylesheet" type="text/css" href='css/pace.css' /> -->
    <link rel="stylesheet" type="text/css" href='css/ServiceGuide.css' />
    <link rel="stylesheet" type="text/css" href="css/animations.css" />
    <link rel="stylesheet" href="css/winbox.min.css">
    <script type="text/javascript" src='js/jquery-3.4.1.min.js'></script>
    <script type="text/javascript" src='js/darktooltip.js'></script>
    <!-- <script type="text/javascript" src='js/pace.js'></script> -->
    <script type="text/javascript" src='js/ServiceGuide.js'></script>
    <script src="js/modernizr.custom.js"></script>
    <script src="js/winbox.min.js"></script>
    <!-- <script src="js/html2canvas.min.js"></script> -->
    


    <style>
        html,
        body {
            position: relative;
            height: 100%;
            overflow: hidden;
        }

        body {
            background: #eee;
            font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
            font-size: 14px;
            color: #000;
            margin: 0;
            padding: 0;
        }

        .pt-main {
            left: 0px;
            top: 0px;
            margin: 0px;
            padding: 0px;
            width: 100%;
            /* /* height: 100%; */
        }

        .pt-perspective {
            position: relative;
            width: 100%;
            height: 100%;
            -webkit-perspective: 1200px;
            -moz-perspective: 1200px;
            perspective: 1200px;
        }

        .pt-page {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            visibility: hidden;
            overflow: hidden;
            -webkit-backface-visibility: hidden;
            -moz-backface-visibility: hidden;
            backface-visibility: hidden;
            -webkit-transform: translate3d(0, 0, 0);
            -moz-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0);
            -webkit-transform-style: preserve-3d;
            -moz-transform-style: preserve-3d;
            transform-style: preserve-3d;
        }

        .pt-page-current,
        .no-js .pt-page {
            visibility: visible;
            z-index: 1;
        }

        .app-page {
            display: block;
            left: 0px;
            top: 0px;
            margin: 0px;
            padding: 0px;
            width: 100%;
            height: 100%;
            border: none;
        }


        .winbox {
            background: #ECECEC;
            border-radius: 4px 4px 0 0;
            border: 1px solid #a7a7a7;
            /* -webkit-transition: box-shadow 0.5s; */
        }

        .wb-title {
            font-family: Roboto;
            font-weight: bold;
            color: #7f7f7f;
            text-decoration: none;
            text-shadow: 0px 1px 0px #fff;
        }

        .wb-body {
            border: 1px solid #a7a7a7;
        }

        .wb-control * {
            -webkit-filter: invert(50%);
        }



        #framepreview {
            display: none;
            position: absolute;
            background: #ECECEC;
            margin: 0;
            top: 0px;
            left: 0px;
            width: 100%;
            height: 100vh
        }

        .grid-container {
            background: none;
            display: grid;
            position: sticky;
            grid-template-columns: repeat(2, 1fr);
            column-gap: 1rem;
            row-gap: 1rem;
            margin: 1rem;
            justify-content: center;
            height: 90vh;
        }

        .grid-item {
            display: flex;
            justify-content: center;
        }

        .grid-item iframe {
            position: relative;
            grid-area: iframe;
            top: 4%;
            left: 4%;
            width: 92%;
            height: 32vh;
            overflow: hidden;
            pointer-events: none;
            opacity: 0.5;

            /* -ms-zoom: 0.75;
            -moz-transform: scale(0.75);
            -moz-transform-origin: 0 0;
            -o-transform: scale(0.75);
            -o-transform-origin: 0 0;
            -webkit-transform: scale(0.75);
            -webkit-transform-origin: 0 0; */

        }

        .html-resize {
            -ms-zoom: 0.7;
            -moz-transform: scale(0.7);
            -moz-transform-origin: 0 0;
            -o-transform: scale(0.7);
            -o-transform-origin: 0 0;
            -webkit-transform: scale(0.7);
            -webkit-transform-origin: 0 0;
            /* width: 50%;
            height: 50%; */
        }

        .grid-item-cover {
            z-index: 500;
            width: 100%;
            height: 40vh;
        }

        .grid-cover-text {
            text-align: center;
            justify-content: center;
            font-size: 32px;
            transform: translate(0%, -100%);
        }
    </style>

    <script>

        var tabbox = 0;
        var mediabox = 0;
        var oldpage = 0;
        var usehitory = false;
        var currentpage = 1;
        var visitedpage = [0];
        var curvisited = -1;


        var ANIM_PRESENTATION = 40;
        var ANIM_EDIAG_EPARTS = 4;
        // var ANIM_OTHER = 1;//67;//54;//36;//51;//36;//16;    
        var ANIM_OTHER = 68;//67;//54;//36;//51;//36;//16;  
        var ANIM_LAST = 1;//67;//54;//36;//51;//36;//16;  
        var ANIM_NEXT = 2;//67;//54;//36;//51;//36;//16;

        function ShowMedia(content) {
            if (mediabox) {
                mediabox.close();
            }
            mediabox = new WinBox("ServiceGuide", {
                border: "0.3em",
                x: "68%",
                y: "66%",
                width: "30%",
                height: "30%",
                hidden: false,
                url: content,
                onclose: function (force) {
                    mediabox = 0;
                }
            });
        }

        function ShowTabs() {
            if (tabbox) {
                tabbox.close();
            }
            tabbox = new WinBox("ServiceGuide", {
                background: "#ECECEC",
                border: "0.3em",
                x: "center",
                y: "center",
                width: "80%",
                height: "80%",
                hidden: false,
                modal: true,
                // onclose: function (force) {
                //     tabbox = 0;
                // }
            });

        }

        function AddPageHistory(page) {
            console.log(visitedpage);
            if (usehitory) {
                usehitory = false;
                return;
            }
            visitedpage = visitedpage.slice(0, curvisited + 1);
            if (page == visitedpage[visitedpage.length - 1]) { return; }
            visitedpage.push(page);
            curvisited = visitedpage.length - 1;
        }

        function ButtonLastPage() {
            if (visitedpage.length == 0) { return; }
            if (curvisited < 0) { curvisited = 0; return; }
            var pagenum = visitedpage[curvisited];
            var cpage = currentpage;
            if ((pagenum == cpage) && (curvisited >= 1)) {
                curvisited = curvisited - 1;
                pagenum = visitedpage[curvisited];
            }
            usehitory = true;
            console.log(pagenum);
            currentpage = pagenum;
            PageTransitions.setPage(pagenum, ANIM_LAST);
        }

        function ButtonNextPage() {
            var size = visitedpage.length;
            if (size == 0) { return; }
            if (curvisited >= size) { curvisited = size - 1; return; }
            var pagenum = visitedpage[curvisited];
            var cpage = currentpage;
            if ((pagenum == cpage) && (curvisited <= size - 2)) {
                curvisited = curvisited + 1;
                pagenum = visitedpage[curvisited];
            }
            usehitory = true;
            currentpage = pagenum;
            PageTransitions.setPage(pagenum, ANIM_NEXT);
        }


        function GoToPage(n, animation) {
            if (n !== oldpage) {
                currentpage = n;
                PageTransitions.setPage(currentpage, animation);
                AddPageHistory(currentpage);
                oldpage = currentpage;
            }
            else { ReloadPage(n); }
        }

        function ReloadPage(n) {
            var id = 'pg' + (n + 1).toString();
            // document.getElementById(id).contentWindow.location.reload();
            document.getElementById(id).src = document.getElementById(id).src
        }

        function PageFromPreview(id) {
            GoToPage(id, ANIM_OTHER);
            tabbox.close();
        }

        window.onmessage = function (event) {

            if (event.data == '_fullscreen_') {
                FullScreen();
            }

            if (event.data == 'media_src') {
                if (sessionStorage.length) {
                    let src = sessionStorage.getItem('_media_src_');


                    // <div id="pt-main" class="pt-perspective">
                    $("#pt-main").removeClass("pt-perspective");
                    $("#pt-main").addClass("grid-container");
                    $("#pt-main .pt-page").addClass("grid-item");
                    $("#pt-main .grid-item").removeClass("pt-page");
                    $("#pt-main .grid-item").addClass("uistyle2");
                    


                    //ShowMedia(src);

                    // ShowTabs();
                    //tabbox.mount($('#framepreview')[0]);
                    // tabbox.mount($('#pt-main')[0]);
                    
                    // $('#framepreview').show();
                    

                   
                    // var item = `
                    // <div class="grid-item">
                    //     <a class="grid-item-cover uistyle2" href="#" onclick="PageFromPreview(0);">
                    //         <iframe></iframe>
                    //         <p class="grid-cover-text">Presentation</p>
                    //     </a>
                    // </div>
                    // `;



                    // // $("#framepreview .grid-container").empty();
                    // // var children = $("#pt-main .pt-page").children().contents().find("body").clone();
                    // var children = $("#pt-main .pt-page").children().clone();
                    // for (var i = 0; i < children.length; i++) {
                    //     // console.log(children[i]);
                    //     var jqitem = $($.parseHTML(item));
                    //     var jqitem_iframe = jqitem.find("iframe");
                    //     //var iframe = $("#pg4").contents().find("html").clone();
                    //     var iframe = children[i];
                    //     jqitem_iframe.replaceWith(iframe);
                    //     // $($.parseHTML(iframe)).attr('id',  "framepreview_" + i.toString());
                    //     $(".grid-container").append(jqitem);
                    // }

                    // $("#framepreview .grid-container body").addClass("html-resize");
                    // var children = $("#framepreview .grid-container body").children();
                    // for (var i = 0; i < children.length; i++) {
                    //     console.log(children[i]);


                    // }

                    // $("#framepreview .grid-container iframe .navbar").addClass("html-resize");
                    // $("#framepreview .grid-container iframe .navbar").hide();
                    // $('iframe').on('load', function () {
                    //     var children = $("#pt-main .pt-page").children().contents().find("body").clone();
                    //     for (var i = 0; i < children.length; i++) {
                    //         console.log(children[i]);
                    //         // $("#framepreview .grid-container iframe").contents().find("body").replaceWith(children[i]);
                    //         $("#framepreview .grid-container iframe body").replaceWith(children[i]);
                    //     }
                    // });

                    // // $("#framepreview_0").on('load', function () {
                    // $("iframe").on('load', function () {
                    //     var src = $(this).attr('src');
                    //     if(src === "ErrorCode.html"){
                    //         console.log(src, 'loaded!');
                    //         // $(this).contents().find("body").replaceWith("<body>Hello every one !</body>");
                    //         $(this).contents().find("body").replaceWith($("#pg4").contents().find("body"));
                    //     }
                        

                    // });


                }
            }

            if (event.data == "_prev_page_history_") {
                // ButtonLastPage();
            }
            if (event.data == "_next_page_history_") {
                // ButtonNextPage();
            }
            if (event.data == 'mframe_goto_Presentation.html') {
                GoToPage(0, ANIM_PRESENTATION);
            }
            if (event.data == 'mframe_goto_Documentation.html') {
                SendCustomEventToIframe("pg2", "shown");
                GoToPage(1, ANIM_OTHER);
            }
            if (event.data == 'mframe_goto_SearchText.html') {
                GoToPage(2, ANIM_OTHER);
            }
            if (event.data == 'mframe_goto_ErrorCode.html') {
                GoToPage(3, ANIM_OTHER);
            }
            var start = 4;
            for (var i = 0; i < productnames.length; i++) {
                if (event.data == 'mframe_goto_ElectricalDiagram_' + productnames[i] + '.html') {
                    GoToPage(start + i, ANIM_OTHER);
                }
            }
            start = 4 + productnames.length;
            for (var i = 0; i < productnames.length; i++) {
                if (event.data == 'mframe_goto_eParts_' + productnames[i] + '.html') {
                    GoToPage(start + i, ANIM_OTHER);
                }
            }
        };

        $(document).ready(function () {

            function AddPages(item, n) {
                for (var i = 0; i < productnames.length; i++) {
                    var id = "pg" + n.toString();
                    var cls = "pt-page pt-page-" + n.toString();
                    var src = item + "_" + productnames[i] + ".html"
                    var page = "<div class='" + cls + "'><iframe class='app-page' id='" + id + "' src='" + src + "'></iframe ></div>";
                    $("#pt-main").append(page);
                    n++;
                }
            }
            var start = 5;
            AddPages("ElectricalDiagram", start);
            start = start + productnames.length;
            AddPages("eParts", start);
            PageTransitions.init();
            AddPageHistory(0);

            $('iframe').on('load', function () {
                var src = $(this).attr('src');
                console.log(src, 'loaded!');

            });
        })

    </script>

</head>

<body>

    <div id="pt-main" class="pt-perspective">
        <div class="pt-page pt-page-1"><iframe class="app-page" id="pg1" src="Presentation.html"></iframe></div>
        <div class="pt-page pt-page-2"><iframe class="app-page" id="pg2" src="Documentation.html"></iframe></div>
        <div class="pt-page pt-page-3"><iframe class="app-page" id="pg3" src="SearchText.html"></iframe></div>
        <div class="pt-page pt-page-4"><iframe class="app-page" id="pg4" src="ErrorCode.html"></iframe></div>
    </div>

    <!-- <div class="grid-item">
        <a class="grid-item-cover uistyle2" href="#" onclick="PageFromPreview(0);">
            <iframe src="Presentation.html"></iframe>
            <p class="grid-cover-text">Presentation</p>
        </a>
    </div> -->

    <!-- <div id="framepreview">
        <div class="grid-container"> -->
            <!-- <div class="grid-item">
                <a class="grid-item-cover uistyle2" href="#" onclick="PageFromPreview(0);">
                    <iframe src="Presentation.html"></iframe>
                    <p class="grid-cover-text">Presentation</p>
                </a>
            </div>
            <div class="grid-item">
                <a class="grid-item-cover uistyle2" href="#" onclick="PageFromPreview(1);">
                    <iframe src="Documentation.html"></iframe>
                    <p class="grid-cover-text">Documentation</p>
                </a>
            </div>
            <div class="grid-item">
                <a class="grid-item-cover uistyle2" href="#" onclick="PageFromPreview(2);">
                    <iframe src="SearchText.html"></iframe>
                    <p class="grid-cover-text">Search by text</p>
                </a>
            </div>
            <div class="grid-item">
                <a class="grid-item-cover uistyle2" href="#" onclick="PageFromPreview(3);">
                    <iframe src="ErrorCode.html"></iframe>
                    <p class="grid-cover-text">Error code</p>
                </a>
            </div> -->
        <!-- </div> -->
    </div>

</body>

<script src="js/pagetransitions.js"></script>
<script>
    //http://localhost:5000/?SearchText
    console.log(window.location.search);
    var search = window.location.search;
    if (search === "?Documentation") {
        GoToPage(1, ANIM_OTHER);
    }
    if (search === "?SearchText") {
        GoToPage(2, ANIM_OTHER);
    }
    if (search === "?ErrorCode") {
        GoToPage(3, ANIM_OTHER);
    }
</script>

</html>
